
//
// This source file is part of appleseed.
// Visit http://appleseedhq.net/ for additional information and resources.
//
// This software is released under the MIT license.
//
// Copyright (c) 2010-2013 Francois Beaune, Jupiter Jazz Limited
// Copyright (c) 2014-2017 Francois Beaune, The appleseedhq Organization
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
//

// appleseed.foundation headers.
#include "foundation/math/rng/distribution.h"
#include "foundation/math/rng/pcg.h"
#include "foundation/math/rng/serialmersennetwister.h"
#ifdef APPLESEED_USE_SSE
#include "foundation/math/rng/simdmersennetwister.h"
#endif
#include "foundation/platform/types.h"
#include "foundation/utility/countof.h"
#include "foundation/utility/test.h"

// Standard headers.
#include <cstddef>
#include <limits>

using namespace foundation;
using namespace std;

TEST_SUITE(Foundation_Math_RNG)
{
    struct FakeRNG
    {
        const uint32 m_value;

        explicit FakeRNG(const uint32 value)
          : m_value(value)
        {
        }

        uint32 rand_uint32() const
        {
            return m_value;
        }
    };

    //
    // rand_float31()
    //

    TEST_CASE(RandInt31_Given0x00000000_ReturnsZero)
    {
        FakeRNG rng(0x00000000);

        const int32 value = rand_int31(rng);

        EXPECT_EQ(0, value);
    }

    TEST_CASE(RandInt31_Given0xFFFFFFFF_ReturnsZero)
    {
        FakeRNG rng(0xFFFFFFFF);

        const int32 value = rand_int31(rng);

        EXPECT_EQ(0x7FFFFFFF, value);
    }

    //
    // rand_int1()
    //

    TEST_CASE(RandInt1_Given0x00000000_ReturnsLowBound)
    {
        FakeRNG rng(0x00000000);

        const int32 value = rand_int1(rng, -12, 42);

        EXPECT_EQ(-12, value);
    }

    TEST_CASE(RandInt1_Given0xFFFFFFFF_ReturnsHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const int32 value = rand_int1(rng, -12, 42);

        EXPECT_EQ(42, value);
    }

    //
    // rand_float1()
    //

    TEST_CASE(RandFloat1_Given0x00000000_ReturnsZero)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float1(rng);

        EXPECT_EQ(0.0f, value);
    }

    TEST_CASE(RandFloat1_Given0xFFFFFFFF_ReturnsOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float1(rng);

        EXPECT_EQ(1.0f, value);
    }

    TEST_CASE(RandFloat1_Given0x00000000_ReturnsLowBound)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float1(rng, -12.0f, 42.0f);

        EXPECT_EQ(-12.0f, value);
    }

    TEST_CASE(RandFloat1_Given0xFFFFFFFF_ReturnsHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float1(rng, -12.0f, 42.0f);

        EXPECT_EQ(42.0f, value);
    }

    //
    // rand_double1()
    //

    TEST_CASE(RandDouble1_Given0x00000000_ReturnsZero)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double1(rng);

        EXPECT_EQ(0.0, value);
    }

    TEST_CASE(RandDouble1_Given0xFFFFFFFF_ReturnsOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double1(rng);

        EXPECT_EQ(1.0, value);
    }

    TEST_CASE(RandDouble1_Given0x00000000_ReturnsLowBound)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double1(rng, -12.0, 42.0);

        EXPECT_EQ(-12.0, value);
    }

    TEST_CASE(RandDouble1_Given0xFFFFFFFF_ReturnsHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double1(rng, -12.0, 42.0);

        EXPECT_EQ(42.0, value);
    }

    //
    // rand_float2()
    //

    TEST_CASE(RandFloat2_Given0x00000000_ReturnsZero)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float2(rng);

        EXPECT_EQ(0.0f, value);
    }

    TEST_CASE(RandFloat2_Given0xFFFFFFFF_ReturnsAlmostOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float2(rng);

        EXPECT_LT(1.0f, value);
    }

    TEST_CASE(RandFloat2_Given0x00000000_ReturnsLowBound)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float2(rng, -12.0f, 42.0f);

        EXPECT_EQ(-12.0f, value);
    }

    TEST_CASE(RandFloat2_Given0xFFFFFFFF_ReturnsAlmostHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float2(rng, -12.0f, 42.0f);

        EXPECT_LT(42.0f, value);
    }

    //
    // rand_double2()
    //

    TEST_CASE(RandDouble2_Given0x00000000_ReturnsZero)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double2(rng);

        EXPECT_EQ(0.0, value);
    }

    TEST_CASE(RandDouble2_Given0xFFFFFFFF_ReturnsAlmostOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double2(rng);

        EXPECT_LT(1.0, value);
    }

    TEST_CASE(RandDouble2_Given0x00000000_ReturnsLowBound)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double2(rng, -12.0, 42.0);

        EXPECT_EQ(-12.0, value);
    }

    TEST_CASE(RandDouble2_Given0xFFFFFFFF_ReturnsAlmostHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double2(rng, -12.0, 42.0);

        EXPECT_LT(42.0, value);
    }

    //
    // rand_float3()
    //

    TEST_CASE(RandFloat3_Given0x00000000_ReturnsAlmostZero)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float3(rng);

        EXPECT_EQ(numeric_limits<float>::epsilon(), value);
    }

    TEST_CASE(RandFloat3_Given0xFFFFFFFF_ReturnsAlmostOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float3(rng);

        EXPECT_LT(1.0f, value);
    }

    TEST_CASE(RandFloat3_Given0x00000000_ReturnsAlmostLowBound)
    {
        FakeRNG rng(0x00000000);

        const float value = rand_float3(rng, -12.0f, 42.0f);

        EXPECT_GT(-12.0f, value);
    }

    TEST_CASE(RandFloat3_Given0xFFFFFFFF_ReturnsAlmostHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const float value = rand_float3(rng, -12.0f, 42.0f);

        EXPECT_LT(42.0f, value);
    }

    //
    // rand_double3()
    //

    TEST_CASE(RandDouble3_Given0x00000000_ReturnsAlmostZero)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double3(rng);

        EXPECT_EQ(numeric_limits<double>::epsilon(), value);
    }

    TEST_CASE(RandDouble3_Given0xFFFFFFFF_ReturnsAlmostOne)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double3(rng);

        EXPECT_LT(1.0, value);
    }

    TEST_CASE(RandDouble3_Given0x00000000_ReturnsAlmostLowBound)
    {
        FakeRNG rng(0x00000000);

        const double value = rand_double3(rng, -12.0, 42.0);

        EXPECT_GT(-12.0, value);
    }

    TEST_CASE(RandDouble3_Given0xFFFFFFFF_ReturnsAlmostHighBound)
    {
        FakeRNG rng(0xFFFFFFFF);

        const double value = rand_double3(rng, -12.0, 42.0);

        EXPECT_LT(42.0, value);
    }
}

TEST_SUITE(Foundation_Math_RNG_PCG)
{
    TEST_CASE(CheckFirstValues)
    {
        static const uint32 Expected[1000] =
        {
             465482994UL, 3895364073UL, 1746730475UL, 3759121132UL, 2984354868UL,
            3193308813UL,  719162516UL, 2669372405UL,  952099657UL, 3848281661UL,
            1722616740UL, 1703410327UL, 1489898431UL, 2808816474UL, 3394935963UL,
            3800733979UL, 2645780359UL,   54025654UL, 1620520937UL,  261133231UL,
            1030578764UL,  807022259UL, 1409000050UL, 1194629604UL, 3777309333UL,
            1570294272UL, 2649937232UL,  857373089UL, 3598020669UL, 1775738823UL,
            3466178238UL, 3827724402UL, 3892889888UL, 1220604704UL, 2032491117UL,
            1023053890UL, 1431308669UL, 1548609434UL, 2152671001UL, 1671576757UL,
            2157114852UL, 3164731816UL, 3064050002UL, 3933235971UL, 3685010053UL,
             244697458UL, 1057877727UL, 3913827785UL, 4040586935UL, 2952457164UL,
            1755638421UL,  318176490UL,  141439085UL,  278066646UL,    6216125UL,
            4112216801UL, 2153261903UL, 3492890592UL, 1475026070UL, 2855248709UL,
            3560663111UL,  969631411UL, 3597755749UL, 1322751635UL,  789892014UL,
            4121396030UL,  733563246UL, 1824419711UL, 3970343011UL, 4009937121UL,
            2637784390UL,   32991992UL, 3020205058UL, 1006006050UL, 3127840334UL,
            4188188064UL, 4009056852UL, 1465278880UL, 3249233677UL, 3753806003UL,
             664373599UL, 1508096799UL, 3394681943UL,   62071327UL,  915232454UL,
            1625211000UL, 2684613559UL, 2922282686UL, 4288936899UL, 1423863364UL,
             134946067UL, 3289865634UL, 3155765718UL, 3091845294UL, 3822057133UL,
            1131131786UL, 4248055303UL, 1322921553UL, 1176461978UL, 3293688225UL,
            3787014237UL, 2765630495UL, 1433364517UL, 3592567205UL, 3283449589UL,
             109306324UL,  656271382UL, 3582449353UL, 4161900925UL,  185344389UL,
            1769123328UL, 3346114032UL, 3122320552UL, 4004922408UL, 1808396717UL,
            3272400844UL, 1961384329UL, 1444279534UL,  709737294UL, 2786215081UL,
            4098000533UL,  629269910UL, 4155652252UL, 2656899968UL,  881889592UL,
            3063710254UL, 3323945442UL, 2741690169UL, 2297777418UL, 4108736600UL,
            3943244610UL, 1147605934UL, 1468227652UL, 4022701806UL, 1151190667UL,
             972758586UL, 1054835633UL, 3707114440UL, 1907540675UL,  324914788UL,
             136492079UL, 1705660957UL, 2427770070UL, 3320260920UL, 3436422337UL,
            2279229591UL, 3745952773UL, 1807062016UL,  225624947UL,   35839144UL,
             897450126UL, 2105937723UL, 2744800013UL, 1344862690UL, 3403500186UL,
            4234886781UL, 2658206965UL, 1330997185UL, 1824411582UL, 3983431514UL,
             761882792UL, 3710709211UL, 1813117973UL, 3212297677UL,  487384258UL,
            2769630333UL, 3682106941UL, 2452362071UL,  340332599UL, 3811708210UL,
            4206963802UL, 1765960700UL,  207478359UL, 1260718904UL, 4024503564UL,
            2206499484UL, 1566084957UL, 3810787984UL, 4045246547UL, 1480492094UL,
            2944768776UL,  361929548UL,  169936580UL,  378736854UL, 2242206212UL,
            2441305762UL, 2980803926UL,   15346626UL, 1963614569UL, 2826471979UL,
            2651250669UL, 2274522419UL, 3468838334UL, 1610833910UL,  688143972UL,
            2293884033UL, 4194680318UL, 1169533019UL, 3046836575UL, 2845509538UL,
             823063969UL, 2076652351UL, 1722229730UL, 3076908003UL, 2319117894UL,
             835368201UL,  406233054UL, 4057401169UL, 2270372618UL, 3917055080UL,
            1460755795UL,  242522141UL,   94961104UL, 3179588930UL, 1263719626UL,
              27593365UL, 3160785324UL, 1801678587UL, 1082312349UL, 3140015414UL,
            3012359102UL, 1541796750UL,  491812712UL, 1639334942UL,  287594015UL,
            2561866516UL, 3426519515UL, 2055710930UL,   85266343UL, 2927118831UL,
            1007103242UL,  455390501UL, 2044299186UL, 1218549315UL, 3936522396UL,
             620543335UL, 4127124522UL, 3135565957UL, 1162143357UL,  405145806UL,
             675370757UL, 3896852661UL,  157894814UL, 1704790987UL, 3749626014UL,
            3519620942UL, 3673387278UL,  109600806UL, 4230191316UL, 3534396608UL,
            4101197030UL, 3558881806UL, 3857954642UL, 2934155368UL, 1012750537UL,
             514464335UL, 3231749283UL, 2224884628UL, 2124276068UL, 1692532105UL,
            2362044988UL, 2770212179UL, 2528157601UL, 1871752329UL, 1040103142UL,
             921873856UL, 3089955944UL, 1619538362UL, 3187911481UL, 4261785566UL,
            4166980944UL, 3536638714UL, 2461152277UL, 1632778664UL,  770986155UL,
            4116686745UL,  319400687UL, 3798220876UL, 3866317149UL, 1346665939UL,
            2966603107UL, 1687366206UL, 2880701602UL,   19312777UL, 3672408015UL,
            3448917902UL, 3542853962UL, 1294299952UL, 2545503747UL, 3265271752UL,
            1872634441UL, 3641405213UL, 1282087244UL,  393803443UL, 3131983704UL,
            4235508104UL, 2420149709UL, 3241080269UL, 1024941664UL, 3897951431UL,
            3548023647UL, 1855080529UL, 3104816674UL, 2649935374UL,  564606414UL,
            2162697020UL, 3697205864UL, 4245419098UL, 3316305136UL,  686505901UL,
             716199242UL, 2658887046UL, 1840279374UL, 3176513445UL, 2827929902UL,
            4278579186UL, 1610895615UL, 1304868922UL, 1605797922UL, 1274808765UL,
            1458924666UL, 4194557538UL,  830890550UL, 3555200470UL, 4120209723UL,
            1378923252UL, 3990108779UL, 4000921909UL, 1273260362UL,  639215459UL,
            1551239150UL,  498502528UL, 3449454753UL, 3657050436UL, 3480834160UL,
            1226782798UL, 4225298341UL, 4205157369UL,  733984732UL, 1455010350UL,
            2792318597UL, 4155647965UL,  438108875UL, 2879456526UL, 2012042651UL,
            3734652999UL, 4209825478UL, 4225277434UL, 3415267156UL, 1580129051UL,
            3752110012UL, 3533790893UL, 1803153174UL,  828152287UL, 1474117358UL,
             256101288UL, 3757978419UL, 2776305617UL, 1990418697UL,  800663818UL,
            2790290134UL, 2772921656UL, 3059333829UL, 1088967793UL, 3086204801UL,
             344889773UL,  220675221UL, 1832222395UL, 2651847300UL, 1188093205UL,
            2482162678UL, 2968175843UL, 3993601096UL, 3382918351UL, 3435872864UL,
            1713943075UL,  185520214UL,  904130304UL, 2156277605UL, 2889862920UL,
            3264857306UL, 3771715412UL, 1768245395UL, 4221013668UL,  872636844UL,
             954019771UL,  189417071UL, 2096666402UL,  353803945UL, 3307302226UL,
            3406269772UL, 3839409977UL, 1519839804UL, 3165110681UL, 1220956337UL,
            1902108067UL, 3657394395UL,  805183825UL, 3604333206UL,  571692744UL,
            2673761298UL, 2261563553UL,  230382783UL,  356025636UL, 1820146399UL,
             134212230UL, 3300287472UL,  259268156UL, 2968352124UL, 3021994189UL,
            1224916309UL, 1291216671UL, 3001213195UL, 3288470723UL, 2746354006UL,
            1502434053UL, 1055034431UL, 3874403205UL, 4244208493UL,  520862961UL,
              51348858UL,  676958606UL, 1473033635UL, 3388165397UL, 1517361556UL,
            1825462694UL,  316109372UL, 4069103744UL, 3070696905UL,   65715771UL,
            3983605689UL, 2924360096UL, 1170124386UL, 1450222948UL,   20691102UL,
            1826512271UL, 4008735827UL, 2299258579UL, 3548681686UL, 1363998507UL,
            1951895778UL, 2146832550UL, 1816438814UL, 2021234720UL, 2962405652UL,
             342110737UL,  647391137UL, 3226139671UL, 2408513992UL,  732560501UL,
             696590447UL, 4072620348UL, 3065013001UL,  952094047UL,  394559597UL,
            1269779113UL, 3185474057UL, 4048567556UL, 2484039105UL, 1777541032UL,
            3866851064UL, 2406122807UL, 1516539538UL, 1073471295UL, 2786063658UL,
              89688024UL,  677739817UL, 1895047365UL, 3597770376UL,  728134790UL,
            4107741178UL, 3034023269UL, 2399538448UL, 3391070040UL, 2378581799UL,
             661872886UL, 3319839853UL, 2004303756UL, 1172539869UL, 3560129569UL,
            3598079215UL, 1225584608UL, 3303541072UL,  762740397UL,  130900830UL,
            1327299177UL, 2275893453UL, 3774271512UL, 4085797628UL, 3755723537UL,
            2486252554UL,   72329892UL, 3732893045UL, 3165583721UL,  729562343UL,
             313762021UL, 2996786180UL, 3494355648UL, 2935020612UL, 2410703511UL,
            1531022709UL, 2604571214UL, 1226502258UL, 4136095834UL, 3255219349UL,
            2860486741UL, 3688367851UL, 3989775160UL,  858953727UL, 3641777467UL,
            3549698342UL, 1135218900UL, 3202256767UL,  337312587UL, 3991884271UL,
             694582815UL, 2551923159UL, 1553729687UL,  546250406UL, 1951752819UL,
            1882094838UL, 2036813231UL, 2549760418UL, 2573075839UL, 2531696804UL,
              68044944UL, 3665444721UL, 3240941724UL, 1630534563UL, 1334014888UL,
            2704482861UL, 3928686790UL, 3369866204UL,  986729554UL, 1034478917UL,
             393391616UL, 1951442357UL, 3471529857UL,  144768560UL, 1344157423UL,
             786938876UL, 1283190813UL, 3927248310UL,  251402307UL,  104337042UL,
             544930794UL, 2217267062UL,  381987884UL, 2594076005UL, 2279833553UL,
             701826400UL, 1311965289UL, 1550005519UL, 3364153542UL, 3642781015UL,
             289358471UL, 3172008619UL,  958913485UL, 2041175232UL, 1905770175UL,
             972497295UL, 3455023600UL, 3329478837UL,  397931201UL, 1085663116UL,
            1687329263UL, 4290267250UL, 2020782527UL, 2325611860UL, 4242873789UL,
             166431405UL, 1809941918UL, 3863545693UL,  684654678UL, 3059190685UL,
            3208436780UL, 3554042095UL, 1153254596UL, 2640150859UL, 3197741756UL,
            3028944694UL,  549767750UL, 1782272849UL, 1835840141UL, 1180449948UL,
            3072163297UL, 3758104312UL,  964613542UL, 3891113402UL, 1697646599UL,
            3168911866UL, 2820170424UL, 3809415428UL, 1942956328UL, 1388394571UL,
            3628288751UL,  805257098UL, 3510090550UL, 1049540951UL, 1407344946UL,
             873816181UL, 3817081998UL, 1438820300UL, 2344750697UL, 2690407112UL,
            2531608377UL, 1120902377UL, 4202049126UL, 3161964145UL, 3299462121UL,
            3362451470UL, 1189824564UL, 3958710760UL, 3734303124UL, 3387546887UL,
            3613276700UL, 3875598669UL,  128023276UL, 4245422123UL, 4221105503UL,
            2018960709UL, 2856792473UL, 4229384364UL, 2777208963UL, 4069470800UL,
            3921081162UL, 3395673425UL, 3980316461UL, 3223362011UL, 2365296896UL,
            3736441138UL, 2057088382UL, 1600132689UL, 3374787265UL, 3678862805UL,
            1068992299UL,  517843887UL,  837323610UL,  859617217UL, 1221791314UL,
            3969753797UL, 3799532205UL,  106653029UL,  970895481UL, 1381363678UL,
            2300178826UL,  758150813UL, 3640290888UL, 2313233378UL, 3004982916UL,
            2399287351UL,  426741654UL, 2119962257UL, 2045433685UL, 3479319578UL,
            1157098845UL, 1832569724UL, 3238341637UL, 3244682063UL,  311114365UL,
            3807196971UL, 2949091294UL,  171208131UL, 4045114636UL, 2199577423UL,
            3803939771UL, 4247235617UL, 2994251157UL, 4181075830UL, 1471125670UL,
            3542471468UL, 1287379416UL, 1594301128UL,  668571501UL, 2053765498UL,
            3215020519UL, 2474077257UL,  692086859UL, 3061837168UL, 1312128685UL,
            1645287161UL,  809331763UL,  167286374UL, 1673084553UL, 2703753573UL,
            3969485877UL, 1080709807UL, 3567096593UL,  846330823UL, 3980732819UL,
            3927110949UL,  899211926UL, 1446293957UL, 1745452116UL,  689646794UL,
             547777106UL, 3396984022UL, 2010604395UL, 2157645177UL,  182647459UL,
            1817251360UL, 2483516668UL, 1995873889UL,  440809281UL, 4182207809UL,
            2473922628UL, 3573437277UL, 3932825655UL,  694941001UL, 1297210299UL,
            2878018727UL,  983045991UL, 2979766881UL, 3824708038UL, 1893046144UL,
            2950260501UL, 3369875908UL, 3948835952UL, 2410606667UL, 1924300086UL,
            2323635649UL, 1095692796UL, 3215651702UL, 3165206374UL, 2035971927UL,
            3211187285UL, 3573977418UL, 3022182967UL, 4241902055UL, 2685286596UL,
            2409689870UL,  389933430UL, 1876139085UL, 2035379173UL, 3156719403UL,
             850616459UL, 1100758070UL, 3259255264UL,  642558827UL, 3060970603UL,
              39762863UL, 2896966783UL, 3841349437UL, 3927325558UL, 3446746799UL,
            3092460994UL, 3462533949UL, 2715100372UL, 3600592348UL, 1438119909UL,
            3389886536UL,  206032886UL, 3423871741UL,  318745766UL, 3022551890UL,
             698159530UL,   26595453UL, 1018694439UL, 3487920415UL,  836133134UL,
            2555459386UL,   13376211UL, 2974935778UL, 3923982110UL, 4128440368UL,
            3151290570UL, 2700878630UL,  349544893UL, 4254434606UL,  620702738UL,
            4184546648UL,   95330427UL, 3685257541UL,  616906128UL, 4096039593UL,
             181324388UL,  213326528UL, 2483036287UL, 3687447591UL, 3082481181UL,
            2804751679UL, 2757863992UL, 3336203251UL, 2426966656UL, 1857597291UL,
            1898028617UL, 2297843497UL, 3115799206UL, 3384611758UL, 3149613215UL,
            3532453271UL, 3292199609UL, 3014987086UL, 3072689674UL, 4081358502UL,
             361834883UL, 2049312339UL,  153039032UL, 4193383831UL, 3558002292UL,
            3582826727UL,  777972122UL,  641638048UL,  285854978UL,  723222147UL,
            2950756410UL, 3666770147UL,   19541310UL, 2944503394UL, 2528939963UL,
            3911995283UL, 4269641626UL, 1854366031UL, 4023317792UL, 2401508969UL,
            1502161369UL,  484087251UL, 1653537256UL, 3678756915UL, 4180845982UL,
            2218674942UL, 3883468233UL,  119533952UL, 3121053955UL,  532580930UL,
            3344794900UL, 1214377745UL, 4020472257UL, 2795807929UL, 1420711044UL,
            3056222270UL, 2578801852UL, 1932552039UL, 1565222480UL,  102525319UL,
            1597046752UL, 4191271569UL, 1858141209UL,  837013685UL, 2433747334UL,
             801945982UL,  959060361UL, 3900212575UL, 2614238724UL, 2356097379UL,
             579520410UL, 3592746657UL,  624064611UL,   40551695UL, 1440244754UL,
            3451319299UL, 1812727217UL, 3063257791UL, 1926605515UL, 1333275492UL,
             286856518UL, 2413498277UL, 4017416493UL, 1800948455UL, 2260693661UL,
            2290564658UL, 1434784375UL, 2488451111UL, 3192152375UL, 2168945383UL,
            1162230581UL, 3014021816UL, 3221872028UL, 3659578390UL, 1777278318UL,
            1977967819UL,  861294495UL,  982368228UL, 3857925954UL,    3574400UL,
            2837466924UL, 2403789615UL,  489421197UL, 2070340707UL,  763511159UL,
            3093034739UL,  564081942UL, 3790255635UL, 1851767311UL,  215873064UL,
            2052885245UL, 2188510630UL, 1500502100UL,  766582603UL, 3510695729UL,
            3633897886UL,  869534498UL, 1753831571UL, 4016802839UL,  102915759UL,
              12219597UL, 1903866871UL, 2275773607UL, 2562346680UL, 3770683037UL,
            1757390667UL, 2600644269UL, 1836138610UL, 2313159592UL, 1176659651UL,
            1966051476UL,  658762759UL, 4017777180UL, 1200918979UL, 3547097818UL,
            1177471069UL, 1587351568UL, 3415751286UL, 3964330266UL, 2359113833UL,
            2568821952UL, 1336884270UL,  836456074UL, 2166701280UL, 1160828307UL,
             750251393UL, 3797918310UL, 3998220478UL, 1541638959UL, 1591470391UL,
            1284682287UL, 1247297436UL, 2244893425UL, 3873319763UL, 3209360521UL,
            1500760917UL, 2824663904UL,  387290747UL, 1992384214UL, 1503258234UL,
            2015988350UL, 2401435878UL, 1413123241UL, 3447743383UL, 4049325490UL,
            3351168044UL, 4248822006UL, 2111054222UL,  299039262UL, 4177777010UL,
            1907627089UL, 1939937892UL, 1225250402UL,  718851315UL, 2395397275UL,
            2505238660UL, 1120665392UL, 3625074646UL, 3532710481UL,  960090563UL,
             881896894UL, 1380412530UL, 2462191171UL,  517723038UL, 3641372153UL,
            1203216216UL,  890039786UL, 3681684286UL, 2878010655UL,  451644272UL,
            1878599910UL, 2022851471UL, 3846368475UL, 4023462736UL,  863533372UL,
             228470501UL, 3978931801UL,  326864213UL,  712089245UL,  145342046UL,
            1324459232UL, 2723749020UL, 3453504904UL, 4239990007UL, 1030934328UL,
            3132636380UL,  599986453UL,  210086237UL,  650681824UL, 2905813400UL,
            2016125599UL, 3120916045UL, 1939318307UL, 1672297945UL, 1645598494UL,
            2294474646UL, 3039133078UL, 1423739948UL, 2636124712UL, 1636318941UL,
            3339854250UL, 1005852513UL,  663467913UL, 3883529571UL, 1694069266UL
        };

        PCG rng;

        for (size_t i = 0; i < 1000; ++i)
            EXPECT_EQ(Expected[i], rng.rand_uint32());
    }
}

TEST_SUITE(Foundation_Math_RNG_SerialMersenneTwister)
{
    TEST_CASE(CheckThousandFirstOutputValues)
    {
        static const uint32 Expected[1000] =
        {
            1067595299UL,  955945823UL,  477289528UL, 4107218783UL, 4228976476UL,
            3344332714UL, 3355579695UL,  227628506UL,  810200273UL, 2591290167UL,
            2560260675UL, 3242736208UL,  646746669UL, 1479517882UL, 4245472273UL,
            1143372638UL, 3863670494UL, 3221021970UL, 1773610557UL, 1138697238UL,
            1421897700UL, 1269916527UL, 2859934041UL, 1764463362UL, 3874892047UL,
            3965319921UL,   72549643UL, 2383988930UL, 2600218693UL, 3237492380UL,
            2792901476UL,  725331109UL,  605841842UL,  271258942UL,  715137098UL,
            3297999536UL, 1322965544UL, 4229579109UL, 1395091102UL, 3735697720UL,
            2101727825UL, 3730287744UL, 2950434330UL, 1661921839UL, 2895579582UL,
            2370511479UL, 1004092106UL, 2247096681UL, 2111242379UL, 3237345263UL,
            4082424759UL,  219785033UL, 2454039889UL, 3709582971UL,  835606218UL,
            2411949883UL, 2735205030UL,  756421180UL, 2175209704UL, 1873865952UL,
            2762534237UL, 4161807854UL, 3351099340UL,  181129879UL, 3269891896UL,
             776029799UL, 2218161979UL, 3001745796UL, 1866825872UL, 2133627728UL,
              34862734UL, 1191934573UL, 3102311354UL, 2916517763UL, 1012402762UL,
            2184831317UL, 4257399449UL, 2899497138UL, 3818095062UL, 3030756734UL,
            1282161629UL,  420003642UL, 2326421477UL, 2741455717UL, 1278020671UL,
            3744179621UL,  271777016UL, 2626330018UL, 2560563991UL, 3055977700UL,
            4233527566UL, 1228397661UL, 3595579322UL, 1077915006UL, 2395931898UL,
            1851927286UL, 3013683506UL, 1999971931UL, 3006888962UL, 1049781534UL,
            1488758959UL, 3491776230UL,  104418065UL, 2448267297UL, 3075614115UL,
            3872332600UL,  891912190UL, 3936547759UL, 2269180963UL, 2633455084UL,
            1047636807UL, 2604612377UL, 2709305729UL, 1952216715UL,  207593580UL,
            2849898034UL,  670771757UL, 2210471108UL,  467711165UL,  263046873UL,
            3569667915UL, 1042291111UL, 3863517079UL, 1464270005UL, 2758321352UL,
            3790799816UL, 2301278724UL, 3106281430UL,    7974801UL, 2792461636UL,
             555991332UL,  621766759UL, 1322453093UL,  853629228UL,  686962251UL,
            1455120532UL,  957753161UL, 1802033300UL, 1021534190UL, 3486047311UL,
            1902128914UL, 3701138056UL, 4176424663UL, 1795608698UL,  560858864UL,
            3737752754UL, 3141170998UL, 1553553385UL, 3367807274UL,  711546358UL,
            2475125503UL,  262969859UL,  251416325UL, 2980076994UL, 1806565895UL,
             969527843UL, 3529327173UL, 2736343040UL, 2987196734UL, 1649016367UL,
            2206175811UL, 3048174801UL, 3662503553UL, 3138851612UL, 2660143804UL,
            1663017612UL, 1816683231UL,  411916003UL, 3887461314UL, 2347044079UL,
            1015311755UL, 1203592432UL, 2170947766UL, 2569420716UL,  813872093UL,
            1105387678UL, 1431142475UL,  220570551UL, 4243632715UL, 4179591855UL,
            2607469131UL, 3090613241UL,  282341803UL, 1734241730UL, 1391822177UL,
            1001254810UL,  827927915UL, 1886687171UL, 3935097347UL, 2631788714UL,
            3905163266UL,  110554195UL, 2447955646UL, 3717202975UL, 3304793075UL,
            3739614479UL, 3059127468UL,  953919171UL, 2590123714UL, 1132511021UL,
            3795593679UL, 2788030429UL,  982155079UL, 3472349556UL,  859942552UL,
            2681007391UL, 2299624053UL,  647443547UL,  233600422UL,  608168955UL,
            3689327453UL, 1849778220UL, 1608438222UL, 3968158357UL, 2692977776UL,
            2851872572UL,  246750393UL, 3582818628UL, 3329652309UL, 4036366910UL,
            1012970930UL,  950780808UL, 3959768744UL, 2538550045UL,  191422718UL,
            2658142375UL, 3276369011UL, 2927737484UL, 1234200027UL, 1920815603UL,
            3536074689UL, 1535612501UL, 2184142071UL, 3276955054UL,  428488088UL,
            2378411984UL, 4059769550UL, 3913744741UL, 2732139246UL,   64369859UL,
            3755670074UL,  842839565UL, 2819894466UL, 2414718973UL, 1010060670UL,
            1839715346UL, 2410311136UL,  152774329UL, 3485009480UL, 4102101512UL,
            2852724304UL,  879944024UL, 1785007662UL, 2748284463UL, 1354768064UL,
            3267784736UL, 2269127717UL, 3001240761UL, 3179796763UL,  895723219UL,
             865924942UL, 4291570937UL,   89355264UL, 1471026971UL, 4114180745UL,
            3201939751UL, 2867476999UL, 2460866060UL, 3603874571UL, 2238880432UL,
            3308416168UL, 2072246611UL, 2755653839UL, 3773737248UL, 1709066580UL,
            4282731467UL, 2746170170UL, 2832568330UL,  433439009UL, 3175778732UL,
              26248366UL, 2551382801UL,  183214346UL, 3893339516UL, 1928168445UL,
            1337157619UL, 3429096554UL, 3275170900UL, 1782047316UL, 4264403756UL,
            1876594403UL, 4289659572UL, 3223834894UL, 1728705513UL, 4068244734UL,
            2867840287UL, 1147798696UL,  302879820UL, 1730407747UL, 1923824407UL,
            1180597908UL, 1569786639UL,  198796327UL,  560793173UL, 2107345620UL,
            2705990316UL, 3448772106UL, 3678374155UL,  758635715UL,  884524671UL,
             486356516UL, 1774865603UL, 3881226226UL, 2635213607UL, 1181121587UL,
            1508809820UL, 3178988241UL, 1594193633UL, 1235154121UL,  326117244UL,
            2304031425UL,  937054774UL, 2687415945UL, 3192389340UL, 2003740439UL,
            1823766188UL, 2759543402UL,   10067710UL, 1533252662UL, 4132494984UL,
              82378136UL,  420615890UL, 3467563163UL,  541562091UL, 3535949864UL,
            2277319197UL, 3330822853UL, 3215654174UL, 4113831979UL, 4204996991UL,
            2162248333UL, 3255093522UL, 2219088909UL, 2978279037UL,  255818579UL,
            2859348628UL, 3097280311UL, 2569721123UL, 1861951120UL, 2907080079UL,
            2719467166UL,  998319094UL, 2521935127UL, 2404125338UL,  259456032UL,
            2086860995UL, 1839848496UL, 1893547357UL, 2527997525UL, 1489393124UL,
            2860855349UL,   76448234UL, 2264934035UL,  744914583UL, 2586791259UL,
            1385380501UL,   66529922UL, 1819103258UL, 1899300332UL, 2098173828UL,
            1793831094UL,  276463159UL,  360132945UL, 4178212058UL,  595015228UL,
             177071838UL, 2800080290UL, 1573557746UL, 1548998935UL,  378454223UL,
            1460534296UL, 1116274283UL, 3112385063UL, 3709761796UL,  827999348UL,
            3580042847UL, 1913901014UL,  614021289UL, 4278528023UL, 1905177404UL,
              45407939UL, 3298183234UL, 1184848810UL, 3644926330UL, 3923635459UL,
            1627046213UL, 3677876759UL,  969772772UL, 1160524753UL, 1522441192UL,
             452369933UL, 1527502551UL,  832490847UL, 1003299676UL, 1071381111UL,
            2891255476UL,  973747308UL, 4086897108UL, 1847554542UL, 3895651598UL,
            2227820339UL, 1621250941UL, 2881344691UL, 3583565821UL, 3510404498UL,
             849362119UL,  862871471UL,  797858058UL, 2867774932UL, 2821282612UL,
            3272403146UL, 3997979905UL,  209178708UL, 1805135652UL,    6783381UL,
            2823361423UL,  792580494UL, 4263749770UL,  776439581UL, 3798193823UL,
            2853444094UL, 2729507474UL, 1071873341UL, 1329010206UL, 1289336450UL,
            3327680758UL, 2011491779UL,   80157208UL,  922428856UL, 1158943220UL,
            1667230961UL, 2461022820UL, 2608845159UL,  387516115UL, 3345351910UL,
            1495629111UL, 4098154157UL, 3156649613UL, 3525698599UL, 4134908037UL,
             446713264UL, 2137537399UL, 3617403512UL,  813966752UL, 1157943946UL,
            3734692965UL, 1680301658UL, 3180398473UL, 3509854711UL, 2228114612UL,
            1008102291UL,  486805123UL,  863791847UL, 3189125290UL, 1050308116UL,
            3777341526UL, 4291726501UL,  844061465UL, 1347461791UL, 2826481581UL,
             745465012UL, 2055805750UL, 4260209475UL, 2386693097UL, 2980646741UL,
             447229436UL, 2077782664UL, 1232942813UL, 4023002732UL, 1399011509UL,
            3140569849UL, 2579909222UL, 3794857471UL,  900758066UL, 2887199683UL,
            1720257997UL, 3367494931UL, 2668921229UL,  955539029UL, 3818726432UL,
            1105704962UL, 3889207255UL, 2277369307UL, 2746484505UL, 1761846513UL,
            2413916784UL, 2685127085UL, 4240257943UL, 1166726899UL, 4215215715UL,
            3082092067UL, 3960461946UL, 1663304043UL, 2087473241UL, 4162589986UL,
            2507310778UL, 1579665506UL,  767234210UL,  970676017UL,  492207530UL,
            1441679602UL, 1314785090UL, 3262202570UL, 3417091742UL, 1561989210UL,
            3011406780UL, 1146609202UL, 3262321040UL, 1374872171UL, 1634688712UL,
            1280458888UL, 2230023982UL,  419323804UL, 3262899800UL,   39783310UL,
            1641619040UL, 1700368658UL, 2207946628UL, 2571300939UL, 2424079766UL,
             780290914UL, 2715195096UL, 3390957695UL,  163151474UL, 2309534542UL,
            1860018424UL,  555755123UL,  280320104UL, 1604831083UL, 2713022383UL,
            1728987441UL, 3639955502UL,  623065489UL, 3828630947UL, 4275479050UL,
            3516347383UL, 2343951195UL, 2430677756UL,  635534992UL, 3868699749UL,
             808442435UL, 3070644069UL, 4282166003UL, 2093181383UL, 2023555632UL,
            1568662086UL, 3422372620UL, 4134522350UL, 3016979543UL, 3259320234UL,
            2888030729UL, 3185253876UL, 4258779643UL, 1267304371UL, 1022517473UL,
             815943045UL,  929020012UL, 2995251018UL, 3371283296UL, 3608029049UL,
            2018485115UL,  122123397UL, 2810669150UL, 1411365618UL, 1238391329UL,
            1186786476UL, 3155969091UL, 2242941310UL, 1765554882UL,  279121160UL,
            4279838515UL, 1641578514UL, 3796324015UL,   13351065UL,  103516986UL,
            1609694427UL,  551411743UL, 2493771609UL, 1316337047UL, 3932650856UL,
            4189700203UL,  463397996UL, 2937735066UL, 1855616529UL, 2626847990UL,
              55091862UL, 3823351211UL,  753448970UL, 4045045500UL, 1274127772UL,
            1124182256UL,   92039808UL, 2126345552UL,  425973257UL,  386287896UL,
            2589870191UL, 1987762798UL, 4084826973UL, 2172456685UL, 3366583455UL,
            3602966653UL, 2378803535UL, 2901764433UL, 3716929006UL, 3710159000UL,
            2653449155UL, 3469742630UL, 3096444476UL, 3932564653UL, 2595257433UL,
             318974657UL, 3146202484UL,  853571438UL,  144400272UL, 3768408841UL,
             782634401UL, 2161109003UL,  570039522UL, 1886241521UL,   14249488UL,
            2230804228UL, 1604941699UL, 3928713335UL, 3921942509UL, 2155806892UL,
             134366254UL,  430507376UL, 1924011722UL,  276713377UL,  196481886UL,
            3614810992UL, 1610021185UL, 1785757066UL,  851346168UL, 3761148643UL,
            2918835642UL, 3364422385UL, 3012284466UL, 3735958851UL, 2643153892UL,
            3778608231UL, 1164289832UL,  205853021UL, 2876112231UL, 3503398282UL,
            3078397001UL, 3472037921UL, 1748894853UL, 2740861475UL,  316056182UL,
            1660426908UL,  168885906UL,  956005527UL, 3984354789UL,  566521563UL,
            1001109523UL, 1216710575UL, 2952284757UL, 3834433081UL, 3842608301UL,
            2467352408UL, 3974441264UL, 3256601745UL, 1409353924UL, 1329904859UL,
            2307560293UL, 3125217879UL, 3622920184UL, 3832785684UL, 3882365951UL,
            2308537115UL, 2659155028UL, 1450441945UL, 3532257603UL, 3186324194UL,
            1225603425UL, 1124246549UL,  175808705UL, 3009142319UL, 2796710159UL,
            3651990107UL,  160762750UL, 1902254979UL, 1698648476UL, 1134980669UL,
             497144426UL, 3302689335UL, 4057485630UL, 3603530763UL, 4087252587UL,
             427812652UL,  286876201UL,  823134128UL, 1627554964UL, 3745564327UL,
            2589226092UL, 4202024494UL,   62878473UL, 3275585894UL, 3987124064UL,
            2791777159UL, 1916869511UL, 2585861905UL, 1375038919UL, 1403421920UL,
              60249114UL, 3811870450UL, 3021498009UL, 2612993202UL,  528933105UL,
            2757361321UL, 3341402964UL, 2621861700UL,  273128190UL, 4015252178UL,
            3094781002UL, 1621621288UL, 2337611177UL, 1796718448UL, 1258965619UL,
            4241913140UL, 2138560392UL, 3022190223UL, 4174180924UL,  450094611UL,
            3274724580UL,  617150026UL, 2704660665UL, 1469700689UL, 1341616587UL,
             356715071UL, 1188789960UL, 2278869135UL, 1766569160UL, 2795896635UL,
              57824704UL, 2893496380UL, 1235723989UL, 1630694347UL, 3927960522UL,
             428891364UL, 1814070806UL, 2287999787UL, 4125941184UL, 3968103889UL,
            3548724050UL, 1025597707UL, 1404281500UL, 2002212197UL,   92429143UL,
            2313943944UL, 2403086080UL, 3006180634UL, 3561981764UL, 1671860914UL,
            1768520622UL, 1803542985UL,  844848113UL, 3006139921UL, 1410888995UL,
            1157749833UL, 2125704913UL, 1789979528UL, 1799263423UL,  741157179UL,
            2405862309UL,  767040434UL, 2655241390UL, 3663420179UL, 2172009096UL,
            2511931187UL, 1680542666UL,  231857466UL, 1154981000UL,  157168255UL,
            1454112128UL, 3505872099UL, 1929775046UL, 2309422350UL, 2143329496UL,
            2960716902UL,  407610648UL, 2938108129UL, 2581749599UL,  538837155UL,
            2342628867UL,  430543915UL,  740188568UL, 1937713272UL, 3315215132UL,
            2085587024UL, 4030765687UL,  766054429UL, 3517641839UL,  689721775UL,
            1294158986UL, 1753287754UL, 4202601348UL, 1974852792UL,   33459103UL,
            3568087535UL, 3144677435UL, 1686130825UL, 4134943013UL, 3005738435UL,
            3599293386UL,  426570142UL,  754104406UL, 3660892564UL, 1964545167UL,
             829466833UL,  821587464UL, 1746693036UL, 1006492428UL, 1595312919UL,
            1256599985UL, 1024482560UL, 1897312280UL, 2902903201UL,  691790057UL,
            1037515867UL, 3176831208UL, 1968401055UL, 2173506824UL, 1089055278UL,
            1748401123UL, 2941380082UL,  968412354UL, 1818753861UL, 2973200866UL,
            3875951774UL, 1119354008UL, 3988604139UL, 1647155589UL, 2232450826UL,
            3486058011UL, 3655784043UL, 3759258462UL,  847163678UL, 1082052057UL,
             989516446UL, 2871541755UL, 3196311070UL, 3929963078UL,  658187585UL,
            3664944641UL, 2175149170UL, 2203709147UL, 2756014689UL, 2456473919UL,
            3890267390UL, 1293787864UL, 2830347984UL, 3059280931UL, 4158802520UL,
            1561677400UL, 2586570938UL,  783570352UL, 1355506163UL,   31495586UL,
            3789437343UL, 3340549429UL, 2092501630UL,  896419368UL,  671715824UL,
            3530450081UL, 3603554138UL, 1055991716UL, 3442308219UL, 1499434728UL,
            3130288473UL, 3639507000UL,   17769680UL, 2259741420UL,  487032199UL,
            4227143402UL, 3693771256UL, 1880482820UL, 3924810796UL,  381462353UL,
            4017855991UL, 2452034943UL, 2736680833UL, 2209866385UL, 2128986379UL,
             437874044UL,  595759426UL,  641721026UL, 1636065708UL, 3899136933UL,
             629879088UL, 3591174506UL,  351984326UL, 2638783544UL, 2348444281UL,
            2341604660UL, 2123933692UL,  143443325UL, 1525942256UL,  364660499UL,
             599149312UL,  939093251UL, 1523003209UL,  106601097UL,  376589484UL,
            1346282236UL, 1297387043UL,  764598052UL, 3741218111UL,  933457002UL,
            1886424424UL, 3219631016UL,  525405256UL, 3014235619UL,  323149677UL,
            2038881721UL, 4100129043UL, 2851715101UL, 2984028078UL, 1888574695UL,
            2014194741UL, 3515193880UL, 4180573530UL, 3461824363UL, 2641995497UL,
            3179230245UL, 2902294983UL, 2217320456UL, 4040852155UL, 1784656905UL,
            3311906931UL,   87498458UL, 2752971818UL, 2635474297UL, 2831215366UL,
            3682231106UL, 2920043893UL, 3772929704UL, 2816374944UL,  309949752UL,
            2383758854UL,  154870719UL,  385111597UL, 1191604312UL, 1840700563UL,
             872191186UL, 2925548701UL, 1310412747UL, 2102066999UL, 1504727249UL,
            3574298750UL, 1191230036UL, 3330575266UL, 3180292097UL, 3539347721UL,
             681369118UL, 3305125752UL, 3648233597UL,  950049240UL, 4173257693UL,
            1760124957UL,  512151405UL,  681175196UL,  580563018UL, 1169662867UL,
            4015033554UL, 2687781101UL,  699691603UL, 2673494188UL, 1137221356UL,
             123599888UL,  472658308UL, 1053598179UL, 1012713758UL, 3481064843UL,
            3759461013UL, 3981457956UL, 3830587662UL, 1877191791UL, 3650996736UL,
             988064871UL, 3515461600UL, 4089077232UL, 2225147448UL, 1249609188UL,
            2643151863UL, 3896204135UL, 2416995901UL, 1397735321UL, 3460025646UL
        };

        static const uint32 InitKey[] = { 0x123UL, 0x234UL, 0x345UL, 0x456UL };
        SerialMersenneTwister rng(InitKey, countof(InitKey));

        for (size_t i = 0; i < 1000; ++i)
            EXPECT_EQ(Expected[i], rng.rand_uint32());
    }
}

#ifdef APPLESEED_USE_SSE

TEST_SUITE(Foundation_Math_RNG_SimdMersenneTwister)
{
    TEST_CASE(CheckThousandFirstOutputValues)
    {
        static const uint32 Expected[1000] =
        {
            3886407011UL, 4281800351UL,  111076728UL,   81347708UL, 3833203606UL,
             556297090UL, 4292688708UL,  260342669UL, 3323730357UL,  155924424UL,
            1997838194UL, 3088719549UL, 1161211799UL,  293884415UL, 3487150750UL,
            3861616023UL, 2769694646UL, 3011126040UL,  262311224UL, 2581246133UL,
            3996561926UL, 1037905631UL, 2726942113UL, 3074783864UL, 2522595150UL,
             273794672UL, 3451558636UL, 4031719585UL, 2696404308UL, 2525707734UL,
            1576178264UL, 4274454893UL, 1743616231UL, 1080187283UL,  330955672UL,
            1152561996UL, 2918045222UL,  265585965UL, 1338757171UL, 1745764590UL,
            1060801047UL, 3614387191UL,   33931444UL, 3178875627UL, 1417632743UL,
            2506314056UL, 2124201440UL,  407821907UL, 3169932376UL, 2523587590UL,
            3037554570UL, 1953296404UL,  922513475UL, 1128201577UL, 1170419982UL,
            2728966839UL, 1022270193UL, 2450795268UL, 3109694330UL,    8260451UL,
            1516342905UL, 1435585434UL, 2677755295UL,   56794240UL, 2746665314UL,
            1328679627UL, 1276249610UL, 1528496398UL, 3094963307UL, 3722760421UL,
             208123785UL, 1804878568UL,  586130022UL, 3428497868UL, 1359379625UL,
            4265212767UL, 4031061886UL,   44831066UL, 1145032489UL, 2024548506UL,
            3020723704UL,  766457964UL, 3236660798UL, 2137006083UL, 4027227077UL,
            3363478772UL, 4072818873UL, 2766431139UL, 1163227543UL,  643940996UL,
            1138066267UL, 4186824334UL, 3714278977UL,  263076582UL, 3349533518UL,
             571545736UL, 2150263036UL, 2532756744UL, 3936093178UL, 1513889719UL,
            1745352786UL, 1656966430UL, 1216370458UL, 2503054925UL, 3665736300UL,
            1575545695UL,  375444373UL, 2999010119UL, 2115967604UL, 3172776887UL,
             465140534UL, 3798324645UL,  977467577UL, 3308178348UL, 2937569156UL,
            2255472861UL, 2829925437UL, 2167167874UL, 3432646076UL, 2811216535UL,
            3570586428UL, 3025152843UL, 1594735626UL, 3383030628UL, 3181186026UL,
             802974985UL, 3683451150UL,  705220991UL, 3880500653UL, 1390427452UL,
             407874837UL, 3390122460UL, 1366012681UL,  893734678UL, 1337857272UL,
            1996859867UL,  628641020UL, 2493672336UL, 1547585818UL,  862987700UL,
            1606354437UL, 1070426107UL,  426052289UL, 2177883338UL, 3495965601UL,
            2207329451UL,  758331906UL, 1408123471UL, 1255269424UL, 3674545455UL,
            2830676914UL, 1684133988UL,  304750832UL,  900679206UL, 2897402762UL,
            4008082397UL, 2514162932UL, 2383761693UL, 3018319380UL, 2690491913UL,
            1181090043UL,  638491075UL, 3266620013UL, 3540383625UL, 1273518795UL,
             487561245UL, 4088046970UL, 1255768239UL, 3814793891UL, 1004485133UL,
            2155759887UL, 1870125254UL, 2948424167UL, 2294936691UL,  627742802UL,
            4071705078UL, 1954110383UL, 3729581021UL,  744048688UL, 2012419079UL,
            2446564917UL, 3594603404UL, 1973206478UL, 2621088187UL, 2395875201UL,
            3485361773UL,  420519696UL,  410396687UL, 2142731670UL, 4241585820UL,
            3216169587UL, 1055926832UL, 1225242494UL, 2580921156UL, 2295439545UL,
            1860970055UL, 1197258090UL,  534689955UL,  128303446UL, 2542298009UL,
            2470895634UL, 2423079975UL, 2563807503UL,  157276933UL, 2183621728UL,
            1050536500UL, 3314069262UL, 3589471524UL, 3464182125UL, 1635073681UL,
             332887291UL, 1054575134UL, 3385321612UL, 1563394065UL, 1179740749UL,
             425655594UL,  266114324UL, 3264456074UL,  899156497UL, 3566843631UL,
            1527686675UL, 3017375154UL, 1056374060UL, 3208904061UL, 3962046851UL,
            2002878677UL, 1427755009UL,  632165846UL, 3783730489UL, 3556960643UL,
            1759787258UL, 3558288429UL, 3813141183UL, 1415714413UL, 2990026503UL,
            3326805639UL,  834862637UL, 3877827029UL,  506216427UL, 4025413172UL,
            2514251441UL, 1662755812UL,  827708521UL, 2284667052UL, 2287033772UL,
            3860110996UL, 2963598547UL, 2098547079UL, 1639755167UL, 3701127300UL,
             615245480UL, 3315632161UL,  655986141UL, 3553163384UL, 3914455257UL,
            2026638759UL, 1081375798UL, 2543358743UL, 1501975602UL, 2829952981UL,
            1568905036UL, 3549344007UL, 3993544389UL, 3922902403UL, 1945601039UL,
            4117478936UL, 4294179351UL, 3803974482UL, 3519181318UL, 1736601686UL,
             283422918UL,  878255976UL, 2570293325UL, 3953290202UL, 3494798861UL,
            3647753889UL, 4261599140UL,   43477882UL,  882694644UL,  916427300UL,
            1883469962UL, 3472070446UL,  840948062UL, 1070838388UL, 2938640304UL,
             170924456UL,  413157396UL, 1688788798UL,  845338463UL,  207677638UL,
            2374054979UL, 3093598473UL, 3216598376UL,  248499183UL, 3967759055UL,
            2799718086UL, 2162269376UL,  628483893UL, 3393868716UL,  537353077UL,
             225772197UL, 1276357535UL, 1151386419UL, 3799648942UL,  775717262UL,
            3421191342UL, 3352369495UL, 1176301660UL,  826903438UL,  771955966UL,
             703662455UL, 3500408312UL, 3965812397UL, 2634406388UL, 2600638422UL,
             433900783UL, 1881539355UL,  152614188UL, 1001034390UL, 3419274097UL,
            3607958781UL, 3263009089UL, 1381719055UL, 3608460687UL,  699585901UL,
            2601456738UL,  701827720UL,  161788133UL, 3114037508UL, 1730058740UL,
            1935321590UL,  809764901UL, 3015873875UL,  996900766UL, 1265496117UL,
             601954268UL, 3324915628UL, 3267673720UL, 3128655414UL, 2061992616UL,
            1225068379UL, 4034553293UL, 3219516429UL, 2354106088UL, 3712443016UL,
            3558482352UL, 3424565169UL,   66652973UL, 1602369262UL, 2478405431UL,
            1953215718UL, 3763884955UL, 2321961497UL, 4034846225UL, 2964427848UL,
            2980412529UL, 1043681536UL,   78708356UL, 2123693711UL, 3749757828UL,
            1699587788UL, 3325106880UL, 1533138712UL,  966842782UL, 2142041330UL,
             331951290UL, 2839273949UL, 2638662908UL, 3057242914UL, 2615193128UL,
            1453714199UL, 2134977452UL,  182401908UL, 1999564260UL, 1760207124UL,
            2351213662UL, 2733285744UL,  745935144UL, 4278636179UL, 1861789766UL,
            3644538614UL, 1504874763UL, 4169371238UL,  139285714UL, 3237710933UL,
            2912828465UL,   63556721UL, 2424288873UL, 1465498015UL, 1750094812UL,
            3387255961UL,  986980570UL, 3520636206UL, 3703009884UL, 1810627870UL,
             638247367UL,  800103969UL,  533461354UL, 3719164082UL, 3416617704UL,
             582286943UL,  107138412UL, 2694850090UL, 2191567919UL,  663787068UL,
            3905244492UL, 1075793301UL, 3963296145UL,  498654974UL,  415913859UL,
             224922429UL,  957693135UL,   20753421UL, 3604487226UL,  176245419UL,
             756236270UL, 1802741190UL, 1167371933UL, 2739973610UL, 3528781257UL,
            1157415106UL, 1118820636UL, 3458247496UL, 3426071999UL, 1513516168UL,
             541006827UL, 1567502872UL, 1054211972UL, 3108187973UL, 3568355298UL,
             437544707UL,  215493191UL, 3406703434UL, 3321185867UL, 1772491122UL,
            3914720953UL, 1014598723UL,  333918716UL, 3041884855UL, 2375348211UL,
             170098352UL,  240932703UL,  936627316UL, 2139228141UL, 3059916219UL,
            2513963963UL,  112660118UL, 4220599362UL, 1082041605UL, 3602805569UL,
            2384684624UL, 1330834152UL, 4182800709UL, 3009712734UL, 4257523904UL,
            2159731903UL, 2025797850UL, 2056433570UL,  349278747UL, 1170424171UL,
             257898828UL, 2188000674UL, 1204405272UL, 3389713953UL, 4274421883UL,
            2794662087UL, 2460352864UL, 3127675894UL, 3021639524UL,  608028006UL,
            2111707400UL, 1787005794UL, 3843272691UL, 3141988567UL, 4196077997UL,
            2897702537UL, 3372399131UL, 3582063297UL, 1578673893UL, 4158772308UL,
            4169229718UL, 1109608889UL, 3321413183UL, 3071034348UL, 3753529331UL,
            1345899260UL,  412497490UL,  147621430UL,  214318180UL, 1578418651UL,
            3343150529UL, 1254740020UL, 3717298856UL, 3299809204UL, 3760154252UL,
             678106837UL, 1480589570UL, 2779667743UL, 3703299966UL, 1996609972UL,
            2450960405UL, 2217729665UL,  263095858UL, 3896594109UL, 3706821089UL,
            1779331587UL,  944437701UL, 1816667206UL, 3470975262UL, 2665594204UL,
            3272830417UL, 3383291758UL, 1100553215UL, 3066409484UL, 2255953998UL,
            4263120961UL, 3903080396UL, 3118336282UL, 1244930791UL, 2776135295UL,
             404172911UL,  935988779UL, 3021878898UL, 2591140119UL, 2855279657UL,
             828977189UL, 1349880831UL,  271405633UL,  513887183UL,  973977998UL,
             818498047UL, 3759094702UL, 1967989616UL, 1645739285UL, 2450937230UL,
            3394484130UL, 3802347325UL, 4188056776UL, 1678519011UL, 4011608337UL,
            3345802689UL, 3739063605UL,  515149797UL, 4110693634UL,  286359712UL,
              58159003UL, 1620037343UL, 1758736877UL, 1108416461UL,  978633298UL,
            3908170134UL,  832999193UL, 3865630340UL, 2696419612UL, 4213969249UL,
             649970127UL,  612427777UL, 1300765532UL,   75897263UL, 1394767950UL,
             920233303UL, 2590798616UL, 3717554842UL, 1279020975UL,  594203750UL,
            2514263416UL, 2806336875UL, 1893328899UL, 3341401053UL, 2408038972UL,
            1199628776UL,  169610427UL, 3626403286UL, 2076132929UL, 2304947701UL,
            1022870336UL, 2137468039UL, 1261296863UL, 2927753974UL, 2127572634UL,
             522582313UL, 1753082133UL, 3047778755UL, 1097852750UL, 2117585055UL,
            1342268395UL, 3018704691UL, 2039924086UL, 4085013780UL, 1150098139UL,
            1471970342UL,  132882672UL, 3577285283UL, 1493520392UL, 2365018644UL,
            1080368309UL, 1593880224UL, 2525716814UL, 1220265805UL, 3235772869UL,
            1140912993UL, 1568018248UL, 1847630808UL, 2235016934UL, 1969624960UL,
            2400798963UL,  396529293UL, 2876404082UL,  374115476UL, 3767411509UL,
            3686923286UL,  269156713UL, 1184297508UL,  156613232UL, 1608282564UL,
            1655626368UL, 2286043979UL, 4148499352UL, 1400217329UL,  746989267UL,
             118760232UL, 3754761427UL, 3991461457UL, 1749683603UL, 1448174823UL,
            1250954867UL,  846463124UL, 3958695790UL, 3740351386UL, 1632150808UL,
            3007550551UL,  382880029UL, 1194390993UL, 1111682635UL, 1559692800UL,
            2257958687UL, 3155266410UL, 2072536932UL,  332962507UL,  298440753UL,
            3586996064UL, 1418147869UL, 3646770130UL,  589633801UL, 1637972417UL,
            3421417825UL,  891276907UL, 2517892630UL,  926748506UL, 1448212968UL,
            1195763027UL, 1191407415UL, 1266564261UL, 2446003846UL,  739349380UL,
            2241384648UL, 2419433486UL, 1265848908UL, 3540493819UL, 3044389380UL,
            1180551193UL,  385247912UL, 3687971870UL, 2933470163UL, 1766292638UL,
            3920228013UL, 4083968751UL,  190207421UL, 1897154699UL, 1385999625UL,
            2589249091UL,   13835880UL, 3271302978UL, 2807909185UL, 1016922355UL,
            1630163316UL, 3203254919UL,  328188864UL, 3987127570UL, 1339850346UL,
            3114841550UL, 2056796190UL, 1661852945UL, 2276546573UL,  744577169UL,
             917967899UL,  442985033UL,   25425073UL, 1772015325UL, 1010457171UL,
            4199113754UL, 2455595434UL, 3779198526UL,  424018762UL, 1252182525UL,
            1500859734UL, 1725596044UL, 2179270330UL, 3664653997UL, 4060184295UL,
            4186918346UL, 1230931642UL, 2535369803UL,  793762983UL,  902779486UL,
             904819110UL, 2106795553UL, 1831821629UL,  151770440UL, 1060730346UL,
             260686731UL, 3294302589UL, 3812541728UL, 2973165963UL, 2769787748UL,
             835036584UL, 1083164731UL, 2357980787UL, 1929093551UL, 2774918826UL,
              21130448UL, 3175936845UL, 1486132047UL, 4239744808UL, 2950777361UL,
            3275643323UL,  798179670UL, 3634512791UL, 3247651617UL, 2623076444UL,
            1537428657UL, 2099953068UL,  908422971UL,  369554428UL,  119654834UL,
            1908459851UL, 2560578188UL, 2508436783UL,  842226718UL, 3437664571UL,
            3013183632UL, 3419217136UL, 1843555493UL, 1288043476UL,  198949359UL,
            2301813358UL, 3675127261UL, 2194239682UL,  932293292UL, 3754075039UL,
            1973360323UL, 3784392333UL, 1750909788UL, 3778476827UL, 3460291337UL,
             562801776UL, 2829044007UL, 1604539079UL,  283365056UL, 3280005866UL,
            1657415187UL, 1950125903UL,  700130005UL, 3904988368UL, 3209052907UL,
             264582882UL,  490291266UL, 3717352569UL, 4103454345UL,  474608553UL,
            3475119427UL, 2360352432UL, 2209943635UL, 1388164703UL,  471352122UL,
            2141591474UL, 3500735720UL,    8628640UL, 2723436555UL, 1457353421UL,
            3806358987UL,  126793832UL, 2251508000UL,  916638683UL,  933016742UL,
            3258782483UL, 2671016879UL, 4190126941UL,  432086625UL, 2127430287UL,
            1815440924UL, 2651537029UL, 3907132339UL, 1091780759UL,  465703611UL,
            3797184691UL, 4076964944UL, 1595769747UL, 2154333579UL, 2176806859UL,
            2877767259UL,  666774740UL, 3493648241UL,  992488857UL,  685541424UL,
            2937035147UL, 2138525956UL,  276742083UL, 3030023740UL, 1724350182UL,
            3561824424UL, 2439326329UL, 3137727159UL, 3532825602UL, 1286564361UL,
            1730650038UL,   47146502UL, 1947106164UL, 2290693563UL, 4237554375UL,
            2169460395UL,  627198754UL, 3267785934UL, 3566267767UL, 4211412669UL,
            1792274052UL, 1558402694UL, 3820357323UL, 3173149465UL, 3611342013UL,
            1626682141UL, 1023174572UL, 2647755299UL, 1086682257UL, 3281068297UL,
            2065457709UL, 2600564494UL, 3174357564UL, 1064120822UL, 3475948281UL,
            2666195316UL,  813720511UL, 1199782038UL, 1186848860UL, 3437401358UL,
             316880925UL, 3547090326UL, 2098800099UL,  798689186UL, 1622398727UL,
             650571965UL,  477578967UL, 1710157637UL,  485820455UL, 2918314263UL,
            3624842452UL,  513206005UL, 2879275335UL, 2573728817UL, 1579049169UL,
            1335411179UL, 3620442791UL,  377149333UL, 2189934814UL,  152599344UL,
              60641839UL, 3947277983UL, 2789496747UL, 2458234304UL,  803406288UL,
            1881317851UL,  914125287UL, 1158363406UL, 3732087233UL, 2747813553UL,
            2718658944UL,  170436177UL, 1191389821UL, 1698013158UL, 1929268873UL,
            1812478568UL,  389149994UL,  552849236UL, 1067196635UL, 1253573071UL,
            1875541284UL, 1385293163UL, 3094213125UL, 2838399165UL, 1045337537UL,
            1117641174UL, 2526606585UL,  354148334UL, 3650301072UL, 2522676029UL,
            3187829406UL,  348039809UL,  767130823UL, 2342437211UL,  533819297UL,
            3335749811UL, 1530481294UL,  868079141UL,  388761146UL, 4143832711UL,
            1282640156UL, 3569483026UL, 4102521131UL, 1945436946UL,  990432123UL,
            1989239488UL, 3368237538UL, 1074880654UL, 1395154184UL, 2893151289UL,
             998491299UL, 4287341670UL, 1965026764UL, 2177870538UL, 1424793411UL,
            4171480614UL, 3739859402UL, 2291099898UL, 1517589883UL, 1276318754UL,
            1928061503UL,   67287416UL, 3453716755UL, 2295378035UL, 1392343377UL,
            2292365750UL, 2129040008UL, 2254206651UL, 2955135517UL,  758411760UL,
             967043516UL,  107901946UL,  117314340UL, 3603424360UL, 1671012578UL,
            2219728876UL, 2912517093UL, 3166690820UL, 2240095861UL, 2176390337UL,
             947054314UL, 2480610701UL, 1510770649UL,  770741919UL,  184855908UL,
            4284459040UL, 3002676248UL, 2500892156UL, 1092722404UL, 1357944234UL,
            2758390695UL, 1117396783UL,  193686985UL, 1758642792UL,  214081719UL,
            1882715032UL,  454274397UL, 1878991883UL,  520172897UL, 1262447113UL,
            1467673599UL, 2101685657UL,  152140659UL, 1868719962UL, 1792314094UL,
              96111461UL,  388908112UL, 3213133738UL, 2553788568UL, 1093991166UL,
            2841328708UL,  484504627UL,  162274077UL, 3134232148UL, 3856069681UL,
            1125009861UL,  648021349UL, 4150339832UL, 2401353698UL,  317094232UL,
            3065672900UL, 2834089878UL, 1712791505UL, 1400354166UL, 4057054433UL,
            1852171224UL, 2757365820UL, 2653144471UL,  510164898UL, 2912173236UL,
            2130137889UL,  585288649UL, 2141196576UL, 1291263962UL, 3837327574UL
        };

        static const uint32 InitKey[] = { 0x123UL, 0x234UL, 0x345UL, 0x456UL };
        SimdMersenneTwister rng(InitKey, countof(InitKey));

        for (size_t i = 0; i < 1000; ++i)
            EXPECT_EQ(Expected[i], rng.rand_uint32());
    }
}

#endif
